using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ShiftOS.Objects
{
    public abstract class Exploit
    {
        public void BeginExploit(string remote_user, bool isMud)
        {
            var ctx = new ExploitContext();
            SendToMUD(remote_user, "hack_getcontext");
            MessageReceived += (u, c, j) =>
            {

            };
            ThisContext = ctx;
        }

        public ExploitContext ThisContext { get; internal set; }

        public virtual void SendToMUD(string target_user, string command, string json = "")
        {
            ThisContext.IsMUDHack = false;
            if (command == "hack_getcontext")
            {
                MessageReceived?.Invoke(target_user, "context_info", ExploitContext.CreateRandom());
            }
        }

        public event MUDMessageEventHandler MessageReceived;


        public abstract void OnRun(ExploitContext ctx);
    }
}
